# Создание и нормализация базы данных

## Цель
Закрепить на практике основные приемы работы с СУБД MongoDB, включая выборку, сортировку, объединение, агрегацию данных и передачу результатов выборки в программу на Python в целях аналитики и дальнейшей обработки.

## Формулировка задания
В этом задании вам предстоит выполнить несколько запросов к базе данных для получения выборок по условиям, а также воспользоваться фреймворком агрегации MongoDB для построения конвейера обработки данных.

Максимальное количество баллов за выполнение домашней работы: 10.

1. Выведите из коллекции `theaters` документы о кинотеатрах в городе Florence, штат KY (1 балл)

2. Сделав запрос к коллекции `comments`, выведите _один_ комментарий (значение поля `text`) пользователя по имени Doreah. (1 балл).

3. Сделав запрос к коллекции `movies`, выведите количество документов, в которых в качестве первого жанра фильма (поле `genres`) указано значение «Horror». (1 балл)

4. Выведите из коллекции `movies` документы о фильмах, которые в качестве первого жанра определены как «Film-Noir» либо «Horror» и были выпущены в период с 1940 по 1949 гг. (включительно). (2 балла)

5. Модифицируйте запрос из задачи 1.4 таким образом, чтобы осуществить _проекцию_: результатом выборки должен стать список словарей, каждый из которых содержит только два поля: `title` и `year`. (1 балл)

6. В рамках этой задачи требуется узнать, какие фильмы получили наибольшее число комментариев. Составьте для этого конвейер агрегации с перечисленными ниже этапами. Для удобства рекомендуется воспользоваться приложением Compass. (3 балла)

7. Используя данные, полученные в задаче 2.1, выведите на экран столбчатую диаграмму, показывающую топ-20 наиболее комментируемых фильмов. По оси ординат выведите названия этих фильмов (подписи разместите слева диаграммы), по оси абсцисс — количество комментариев. Для решения задачи можно использовать любую библиотеку, например Seaborn или Matplotlib. (1 балл)

## Как отправить задание на проверку
1. Загрузить файлы в GitHub.
2. В форму сдачи приложить ссылку на репозиторий.
3. Назвать файлы вашим ФИО.

## Ожидаемый результат
Выполнение данной работы позволит получить опыт в:
- Раворачивании Mongodb claster.
- Выборка данных из различных документов

## Подготовка к запуску ноутбука
1. Зарегистрируйтесь в сервисе MongoDB Atlas: https://www.mongodb.com/atlas/database.
2. Создайте кластер уровня M0 (это бесплатно).
3. Добавьте в кластер тестовую базу данных `sample_mflix`, используя опцию Load Sample Dataset.
В качестве альтернативы вы можете установить MongoDB на свой локальный компьютер и импортировать необходимые датасеты в свою СУБД, загрузив их по ссылке: https://github.com/neelabalan/mongodb-sample-dataset/tree/main/sample_mflix. Для этого подключитесь к своему серверу через Compass, создайте новую БД, создайте для каждого датасета коллекцию и щелкните «Add data» → «Import JSON or CSV file».

4. Установить зависимости из **requirements.txt**
5. Задать username, пароль, url для вашей базы данных. В ноутбуке используется dbus для получения кредов из хранилища по ключу **mongodb**, если у вас не установлен dbus или нет хранилища, вставьте необходимые данные для подключения к базе. 
6. Запустить все ячейки.